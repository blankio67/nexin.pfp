<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Custom Profiles</title>
<style>
  :root {
    --accent:#6c5ce7;
    --bg:#0f1724;
    --card:#0b1220;
    --muted:#9aa4b2;
  }
  *{box-sizing:border-box;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;}
  html,body{
    margin:0;height:100%;
    background:url("assets/background.png") center center/cover no-repeat fixed;
    color:#e6eef6;
  }

  /* --- Top bar --- */
  header{
    position:fixed;top:12px;left:50%;transform:translateX(-50%);
    width:90%;max-width:1000px;
    background:rgba(15,23,36,0.85);backdrop-filter:blur(12px);
    border-radius:18px;padding:10px 20px;
    display:flex;align-items:center;justify-content:center;
    box-shadow:0 8px 25px rgba(0,0,0,0.4);z-index:1000;
  }
  header img{
    position:absolute;left:16px;width:36px;height:36px;border-radius:50%;
  }
  header h1{font-size:20px;margin:0;color:white;}
  .nav-buttons{position:absolute;right:16px;display:flex;gap:10px;}
  .nav-buttons button{
    padding:8px 14px;border:none;border-radius:18px;
    cursor:pointer;color:white;font-weight:600;transition:all .2s ease;
  }
  .login-btn{background:linear-gradient(90deg,#8a5cf6,#6c5ce7);}
  .login-btn:hover{box-shadow:0 0 10px rgba(108,92,231,0.6);}
  .signup-btn{background:linear-gradient(90deg,#3a3b3f,#5a5c60);}
  .signup-btn:hover{box-shadow:0 0 10px rgba(255,255,255,0.2);}

  .container{max-width:980px;margin:120px auto 32px auto;padding:28px;}
  .card{
    background:rgba(11,18,32,0.85);padding:20px;border-radius:12px;
    box-shadow:0 6px 20px rgba(3,6,23,.6);
  }
  input,textarea{
    width:100%;padding:10px;border-radius:8px;margin-bottom:10px;
    border:1px solid rgba(255,255,255,0.08);
    background:rgba(255,255,255,0.05);color:inherit;
  }
  button.main{
    background:var(--accent);border:none;padding:10px 12px;
    border-radius:9px;color:white;cursor:pointer;font-weight:600;
  }
  .pfp{width:80px;height:80px;border-radius:50%;object-fit:cover;
       border:2px solid var(--accent);margin-bottom:12px;}
  .profile{text-align:center;}
  .modal{
    display:none;position:fixed;top:0;left:0;width:100%;height:100%;
    background:rgba(0,0,0,0.6);justify-content:center;align-items:center;
    z-index:2000;
  }
  .modal-content{
    background:rgba(11,18,32,0.95);padding:24px;border-radius:16px;
    width:320px;text-align:center;animation:slide .25s ease;
  }
  @keyframes slide{from{transform:translateY(-30px);opacity:0;}to{transform:translateY(0);opacity:1;}}
</style>
</head>
<body>
<header>
  <img src="assets/logo.png" alt="Logo"/>
  <h1>Custom Profiles</h1>
  <div class="nav-buttons" id="navBtns">
    <button class="login-btn" onclick="openModal('loginModal')">Login</button>
    <button class="signup-btn" onclick="openModal('signupModal')">Sign Up</button>
  </div>
</header>

<div class="container" id="content"></div>

<!-- LOGIN MODAL -->
<div id="loginModal" class="modal">
  <div class="modal-content">
    <h2>Login</h2>
    <input id="loginUser" placeholder="Username">
    <input id="loginPass" type="password" placeholder="Password">
    <button class="main" onclick="login()">Login</button><br><br>
    <button onclick="closeModal('loginModal')">Close</button>
  </div>
</div>

<!-- SIGNUP MODAL -->
<div id="signupModal" class="modal">
  <div class="modal-content">
    <h2>Sign Up</h2>
    <input id="newUser" placeholder="Username">
    <input id="newPass" type="password" placeholder="Password">
    <input id="newPfp" placeholder="Profile Picture URL">
    <textarea id="newBio" placeholder="Bio..."></textarea>
    <button class="main" onclick="signup()">Create Account</button><br><br>
    <button onclick="closeModal('signupModal')">Close</button>
  </div>
</div>

<script>
  const content=document.getElementById("content");
  const navBtns=document.getElementById("navBtns");

  function openModal(id){document.getElementById(id).style.display="flex";}
  function closeModal(id){document.getElementById(id).style.display="none";}

  function getUsers(){return JSON.parse(localStorage.getItem("users")||"{}");}
  function saveUsers(u){localStorage.setItem("users",JSON.stringify(u));}
  function currentUser(){return localStorage.getItem("currentUser");}

  function signup(){
    const u=document.getElementById("newUser").value.trim();
    const p=document.getElementById("newPass").value;
    const pfp=document.getElementById("newPfp").value||"https://via.placeholder.com/80";
    const bio=document.getElementById("newBio").value||"";
    if(!u||!p)return alert("Enter username and password");
    let users=getUsers();
    if(users[u])return alert("Username exists!");
    users[u]={password:p,pfp,bio};
    saveUsers(users);
    localStorage.setItem("currentUser",u);
    closeModal("signupModal");
    renderDashboard(u);
    history.pushState({}, "", "/dashboard");
  }

  function login(){
    const u=document.getElementById("loginUser").value.trim();
    const p=document.getElementById("loginPass").value;
    let users=getUsers();
    if(users[u]&&users[u].password===p){
      localStorage.setItem("currentUser",u);
      closeModal("loginModal");
      renderDashboard(u);
      history.pushState({}, "", "/dashboard");
    }else alert("Invalid credentials");
  }

  function logout(){
    localStorage.removeItem("currentUser");
    route();
  }

  function renderHome(){
    navBtns.style.display="flex";
    content.innerHTML=`
      <div class="card">
        <h2>Welcome to Custom Profiles!</h2>
        <p>Create your own profile and customize it easily.</p>
        <p>Sign Up or Login above to get started.</p>
      </div>`;
  }

  function renderProfile(u){
    let users=getUsers();const d=users[u];
    if(!d){renderHome();return;}
    navBtns.style.display="flex";
    content.innerHTML=`
      <div class="card profile">
        <img class="pfp" src="${d.pfp}" alt="${u}">
        <h2>@${u}</h2>
        <p>${d.bio||"No bio yet."}</p>
        <a href="data:text/plain,Default CPP content" download="default.cpp">
          <button class="main">Download default.cpp</button>
        </a>
      </div>`;
  }

  function renderDashboard(u){
    navBtns.style.display="none";
    let users=getUsers();const d=users[u];
    content.innerHTML=`
      <div class="card">
        <h2>Dashboard</h2>
        <p>Welcome, <b>@${u}</b></p>
        <img class="pfp" src="${d.pfp}" alt="pfp">
        <br><br>
        <label>Profile Picture URL</label>
        <input id="editPfp" value="${d.pfp}">
        <label>Bio</label>
        <textarea id="editBio">${d.bio}</textarea>
        <button class="main" onclick="saveProfile('${u}')">Save Changes</button>
        <br><br>
        <a href="data:text/plain,Default CPP content" download="default.cpp">
          <button>Download default.cpp</button>
        </a>
        <br><br>
        <button onclick="logout()">Logout</button>
      </div>`;
  }

  function saveProfile(u){
    let users=getUsers();
    users[u].pfp=document.getElementById("editPfp").value;
    users[u].bio=document.getElementById("editBio").value;
    saveUsers(users);
    alert("Profile saved!");
    renderDashboard(u);
  }

  function route(){
    const path=window.location.pathname.slice(1);
    const user=currentUser();
    if(path==="dashboard"&&user){renderDashboard(user);}
    else if(path&&getUsers()[path]){renderProfile(path);}
    else if(user){renderDashboard(user);}
    else{renderHome();}
  }
  window.onpopstate=route;
  route();
</script>
</body>
</html>
